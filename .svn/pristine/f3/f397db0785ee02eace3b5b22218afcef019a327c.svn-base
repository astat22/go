import java.io.*;
import java.net.*;

public class Server
{
	public static void main(String[] args) throws Exception
	{
		/*Tworze na podanym porcie gniazdo serwera,
		 *które posiada dodatkowe funkcjonalnoœci umo¿liwiaj¹ce równoczesn¹ obs³ugê wielu po³¹czeñ.
		 */
		ServerSocket listener = new ServerSocket(8989);
		System.out.println("Go game server is running");
		try
		{
			while (true)
			{
				/*Tworze nowa gre, do której bêdê przypisywac graczy*/
				Game newGame = new Game();
				/* Metoda accept() czeka na nadejœcie po³¹czenia, 
				 * jeœli ¿¹danie takie po³¹czenia nadejdzie, 
				 * to zwraca nowe gniazdo s³u¿¹ce do obs³ugi tego po³¹czenia.*/
				Game.Player playerWhite = newGame.new Player(listener.accept(),Colour.WHITE);
				Game.Player playerBlack = newGame.new Player(listener.accept(),Colour.BLACK);
				/*Okreslam przeciwnikow*/
				playerWhite.setOpponent(playerBlack);
				playerBlack.setOpponent(playerWhite);
				game.currentPlayer = playerBlack;
				/*Metoda start() powoduje rozpoczêcie wykonania kodu z klasy Player*/
				playerBlack.start();
				playerWhite.start();
			}
		}
		finally
		{
			listener.close();
		}
	}
}